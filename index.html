<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Divélun | Aprende Japonés</title>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #4361ee;
            --primary-light: #eef2ff;
            --secondary-color: #7209b7;
            --accent-color: #f72585;
            --light-bg: #f8fafc;
            --card-bg: #ffffff;
            --text-dark: #1e293b;
            --text-light: #64748b;
            --border-color: #e2e8f0;
            --success-color: #10b981;
            --shadow-light: 0 4px 20px rgba(0, 0, 0, 0.08);
            --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.12);
            --plyr-color-main: var(--primary-color);
            --gradient-primary: linear-gradient(135deg, #4361ee 0%, #3a56d4 100%);
            --gradient-accent: linear-gradient(135deg, #f72585 0%, #b5179e 100%);
        }

        * {
            box-sizing: border-box;
        }

        body { 
            margin: 0; 
            padding: 0; 
            background: var(--light-bg);
            font-family: 'Inter', sans-serif; 
            color: var(--text-dark);
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* --- CONTENEDOR PARA ESCRITORIO --- */
        @media (min-width: 768px) {
            .desktop-container {
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
                background: linear-gradient(135deg, #f0f4ff 0%, #f8fafc 100%);
                padding: 20px;
            }
            
            .content-wrapper {
                width: 100%;
                max-width: 420px;
                background: var(--card-bg);
                border-radius: 24px;
                box-shadow: var(--shadow-medium);
                overflow: hidden;
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }
            
            .content-wrapper:hover {
                transform: translateY(-5px);
                box-shadow: 0 15px 40px rgba(67, 97, 238, 0.15);
            }
        }

        @media (max-width: 767px) {
            .desktop-container {
                display: block;
                background: linear-gradient(135deg, #f0f4ff 0%, #f8fafc 100%);
                min-height: 100vh;
            }
            
            .content-wrapper {
                width: 100%;
                max-width: 100%;
                background: var(--card-bg);
            }
        }

        /* --- LECCIONES (MOSTRAR/OCULTAR) --- */
        .lesson-section {
            display: none;
        }
        
        .lesson-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* --- ENCABEZADO CON LOGO --- */
        .app-header {
            padding: 20px 24px 10px;
            background: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);
        }
        
        .logo-text {
            font-weight: 800;
            font-size: 1.4rem;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: -0.5px;
        }
        
        .lesson-counter {
            background: var(--primary-light);
            color: var(--primary-color);
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .lesson-counter i {
            font-size: 0.7rem;
        }

        /* --- VIDEO HERO --- */
        .hero-video-section { 
            width: 100%; 
            background: #000; 
            position: relative;
            border-radius: 0;
        }
        
        .video-box { 
            position: relative; 
            width: 100%; 
            overflow: hidden; 
            line-height: 0; 
            z-index: 0; 
            -webkit-tap-highlight-color: transparent; 
            touch-action: manipulation; 
            aspect-ratio: 16/9;
        }

        /* --- FEEDBACK VISUAL MEJORADO --- */
        .tap-feedback {
            position: absolute; top: 0; height: 100%; width: 50%;
            display: flex; align-items: center; justify-content: center;
            background: rgba(67, 97, 238, 0.15); 
            opacity: 0; 
            pointer-events: none; 
            z-index: 5;
            transition: opacity 0.3s ease;
        }
        .tap-feedback.left { left: 0; border-radius: 0 50% 50% 0; }
        .tap-feedback.right { right: 0; border-radius: 50% 0 0 50%; }
        .tap-icon { 
            color: white; 
            background: rgba(255, 255, 255, 0.2);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
            transform: scale(0.7); 
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }
        .tap-feedback.animate { opacity: 1; }
        .tap-feedback.animate .tap-icon { transform: scale(1); }

        /* --- ÁREAS TÁCTILES --- */
        .touch-area {
            position: absolute; top: 0; height: 100%; 
            z-index: 3; /* Encima del video pero debajo del botón de pausa */
        }
        
        .touch-area.left { 
            left: 0; 
            width: 30%; /* Solo el 30% izquierdo para doble toque */
        }
        
        .touch-area.right { 
            right: 0; 
            width: 30%; /* Solo el 30% derecho para doble toque */
        }
        
        .touch-area.center {
            left: 30%; width: 40%; /* Centro del 40% para pausa */
        }

        /* --- BOTÓN INICIO MEJORADO --- */
        .start-screen-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex; align-items: center; justify-content: center;
            z-index: 20; cursor: pointer; 
            transition: opacity 0.3s ease, visibility 0.3s;
            backdrop-filter: blur(3px);
        }
        
        .start-screen-overlay.hidden { 
            opacity: 0; 
            visibility: hidden; 
            pointer-events: none; 
        }
        
        .big-play-btn { 
            width: 80px; 
            height: 80px; 
            background: var(--gradient-primary); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            box-shadow: 0 8px 25px rgba(67, 97, 238, 0.5);
            border-radius: 50%;
            border: none;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }
        
        .big-play-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 30px rgba(67, 97, 238, 0.6);
        }
        
        .big-play-btn i {
            font-size: 28px;
            color: white;
            margin-left: 5px;
        }

        /* --- BOTÓN DE PAUSA MEJORADO --- */
        .pause-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; align-items: center; justify-content: center;
            z-index: 18; pointer-events: none; opacity: 0;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(2px);
        }
        
        .pause-overlay.visible { 
            opacity: 1; 
            pointer-events: auto; /* Habilitar interacción cuando es visible */
        }
        
        .pause-btn { 
            width: 80px; 
            height: 80px; 
            background: var(--gradient-primary); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            box-shadow: 0 8px 25px rgba(67, 97, 238, 0.5);
            border-radius: 50%;
            border: none;
            opacity: 0.95;
            cursor: pointer; /* Cambiar cursor a pointer */
            transition: transform 0.2s ease, opacity 0.2s ease;
        }
        
        .pause-btn:hover {
            transform: scale(1.05);
            opacity: 1;
        }
        
        .pause-btn i {
            font-size: 28px;
            color: white;
        }

        /* --- CONTROLES SIMPLIFICADOS MEJORADOS --- */
        .plyr__controls { 
            background: linear-gradient(transparent, rgba(0,0,0,0.8)) !important; 
            padding: 10px 15px !important; 
            min-height: 50px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }
        
        .plyr__progress {
            display: none !important;
        }
        
        .plyr__time--duration {
            display: block !important; 
            visibility: visible !important;
            font-size: 0.85rem !important; 
            font-weight: 600 !important;
            color: #ffffff !important;
            margin: 0 !important;
            text-align: center;
            font-family: 'Inter', sans-serif;
        }
        
        .plyr__time--current { 
            display: none !important; 
        }
        
        .plyr__control--play {
            display: none !important;
        }
        
        /* Ocultar botón de pantalla completa */
        .plyr__control--fullscreen {
            display: none !important;
        }
        
        .plyr__controls__item:not(.plyr__time--duration) {
            display: none !important;
        }

        /* --- INDICADOR DE BUCLE MEJORADO --- */
        .loop-indicator {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255, 255, 255, 0.95);
            color: var(--primary-color);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            z-index: 10;
            display: flex;
            align-items: center;
            gap: 8px;
            pointer-events: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .loop-indicator i {
            font-size: 0.9rem;
            color: var(--primary-color);
        }

        /* --- CONTENIDO MEJORADO --- */
        .content-container { 
            padding: 24px; 
            background: var(--card-bg);
        }
        .lesson-title { 
            font-size: 1.5rem; 
            font-weight: 800; 
            margin-bottom: 12px; 
            color: var(--text-dark);
            line-height: 1.3;
        }
        
        .lesson-title span {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .lesson-description {
            color: var(--text-light);
            font-size: 0.95rem;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .feature-item {
            background: var(--primary-light);
            padding: 12px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .feature-icon {
            width: 36px;
            height: 36px;
            background: var(--gradient-primary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }
        
        .feature-text {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .navigation-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        .nav-btn { 
            display: inline-flex; 
            align-items: center;
            justify-content: center;
            background: var(--gradient-primary); 
            color: white; 
            padding: 14px 24px; 
            border-radius: 12px; 
            font-weight: 700; 
            text-decoration: none; 
            font-size: 0.9rem;
            flex: 1;
            text-align: center;
            box-sizing: border-box;
            border: none;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 15px rgba(67, 97, 238, 0.3);
        }
        
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(67, 97, 238, 0.4);
        }
        
        .nav-btn.prev {
            background: var(--light-bg);
            color: var(--text-dark);
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .nav-btn.prev:hover {
            background: #f1f5f9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .nav-btn i {
            margin: 0 5px;
            font-size: 0.9rem;
        }
        
        .progress-container {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85rem;
            color: var(--text-light);
            font-weight: 600;
        }
        
        .progress-bar {
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 3px;
            width: 50%; /* Para la lección 1 */
            transition: width 0.5s ease;
        }
        
        #lesson2 .progress-fill {
            width: 100%; /* Para la lección 2 */
        }

        /* --- MEJORAS PARA MÓVIL --- */
        @media (max-width: 767px) {
            .video-box {
                aspect-ratio: 16/9;
            }
            
            .hero-video-section {
                background: #000;
            }
            
            .big-play-btn {
                width: 90px;
                height: 90px;
            }
            
            .big-play-btn i {
                font-size: 32px;
            }
            
            .pause-btn {
                width: 90px;
                height: 90px;
            }
            
            .pause-btn i {
                font-size: 32px;
            }
            
            .loop-indicator {
                top: 20px;
                left: 20px;
                padding: 10px 18px;
                font-size: 0.8rem;
            }
            
            .app-header {
                padding: 20px 20px 15px;
            }
            
            .lesson-title {
                font-size: 1.7rem;
            }
            
            .content-container {
                padding: 24px 20px;
            }
            
            .nav-btn {
                padding: 16px 20px;
                font-size: 1rem;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
        }

        /* --- ESTILOS DEL REPRODUCTOR --- */
        .plyr__video-wrapper {
            width: 100%;
            height: 100%;
        }
        
        .plyr--video {
            height: 100%;
        }
        
        .plyr__poster {
            background-size: cover !important;
        }
        
        /* --- ANIMACIONES --- */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        /* --- ESTILOS DE FOOTER --- */
        .app-footer {
            padding: 15px 24px;
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-light);
            border-top: 1px solid var(--border-color);
            background: var(--card-bg);
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }
        
        .footer-link {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.85rem;
            transition: color 0.2s;
        }
        
        .footer-link:hover {
            color: var(--secondary-color);
        }
    </style>
</head>
<body>

    <!-- Contenedor principal -->
    <div class="desktop-container">
        <div class="content-wrapper">
            
            <!-- Encabezado con logo -->
            <div class="app-header">
                <div class="logo-container">
                    <div class="logo-icon">D</div>
                    <div class="logo-text">Divélun</div>
                </div>
                <div class="lesson-counter" id="lessonCounter">
                    <i class="fas fa-book-open"></i>
                    <span>Lección 1 de 2</span>
                </div>
            </div>
            
            <!-- LECCIÓN 1: NUEVO VIDEO 1 -->
            <div class="lesson-section active" id="lesson1">
                <div class="hero-video-section">
                    <div class="video-box" id="videoWrapper1">

                        <!-- Indicador de bucle de 30 segundos -->
                        <div class="loop-indicator" id="loopIndicator1">
                            <i class="fas fa-redo"></i>
                            <span>BUCLE: 30 SEGUNDOS</span>
                        </div>

                        <div class="tap-feedback left" id="feedbackLeft1">
                            <div class="tap-icon">
                                <i class="fas fa-backward"></i>
                            </div>
                        </div>
                        <div class="tap-feedback right" id="feedbackRight1">
                            <div class="tap-icon">
                                <i class="fas fa-forward"></i>
                            </div>
                        </div>

                        <!-- Áreas táctiles invisibles -->
                        <div class="touch-area left" id="touchLeft1"></div>
                        <div class="touch-area center" id="touchCenter1"></div>
                        <div class="touch-area right" id="touchRight1"></div>

                        <!-- Overlay de pausa con botón azul circular -->
                        <div class="pause-overlay" id="pauseOverlay1">
                            <button class="pause-btn" id="pauseButton1">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>

                        <div class="start-screen-overlay" id="startScreen1">
                            <button class="big-play-btn pulse-animation">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                        
                        <!-- VIDEO 1: https://www.youtube.com/watch?v=dV2sSjh1rlA -->
                        <div id="player1" data-plyr-provider="youtube" data-plyr-embed-id="dV2sSjh1rlA"></div>
                    </div>
                </div>

                <div class="content-container">
                    <h1 class="lesson-title">Lección 1: <span>Frases Básicas</span></h1>
                    <p class="lesson-description">Domina las expresiones fundamentales del japonés con esta lección interactiva. Aprende a saludar, presentarte y formular preguntas esenciales.</p>
                    
                    <div class="features-grid">
                        <div class="feature-item">
                            <div class="feature-icon">
                                <i class="fas fa-redo"></i>
                            </div>
                            <div class="feature-text">Bucle de 30 segundos</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">
                                <i class="fas fa-hand-point-up"></i>
                            </div>
                            <div class="feature-text">Controles táctiles</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">
                                <i class="fas fa-volume-up"></i>
                            </div>
                            <div class="feature-text">Audio claro</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="feature-text">A tu propio ritmo</div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="nav-btn prev" disabled>
                            <i class="fas fa-arrow-left"></i> Anterior
                        </button>
                        <button class="nav-btn next" id="nextLesson1">
                            Siguiente <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-text">
                            <span>Progreso del curso</span>
                            <span>50%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LECCIÓN 2: NUEVO VIDEO 2 -->
            <div class="lesson-section" id="lesson2">
                <div class="hero-video-section">
                    <div class="video-box" id="videoWrapper2">

                        <!-- Indicador de bucle de 30 segundos -->
                        <div class="loop-indicator" id="loopIndicator2">
                            <i class="fas fa-redo"></i>
                            <span>BUCLE: 30 SEGUNDOS</span>
                        </div>

                        <div class="tap-feedback left" id="feedbackLeft2">
                            <div class="tap-icon">
                                <i class="fas fa-backward"></i>
                            </div>
                        </div>
                        <div class="tap-feedback right" id="feedbackRight2">
                            <div class="tap-icon">
                                <i class="fas fa-forward"></i>
                            </div>
                        </div>

                        <!-- Áreas táctiles invisibles -->
                        <div class="touch-area left" id="touchLeft2"></div>
                        <div class="touch-area center" id="touchCenter2"></div>
                        <div class="touch-area right" id="touchRight2"></div>

                        <!-- Overlay de pausa con botón azul circular -->
                        <div class="pause-overlay" id="pauseOverlay2">
                            <button class="pause-btn" id="pauseButton2">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>

                        <div class="start-screen-overlay" id="startScreen2">
                            <button class="big-play-btn pulse-animation">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                        
                        <!-- VIDEO 2: https://www.youtube.com/watch?v=XGP45WwQxl8 -->
                        <div id="player2" data-plyr-provider="youtube" data-plyr-embed-id="XGP45WwQxl8"></div>
                    </div>
                </div>

                <div class="content-container">
                    <h1 class="lesson-title">Lección 2: <span>Conversación Básica</span></h1>
                    <p class="lesson-description">Avanza en tu aprendizaje con diálogos prácticos para situaciones cotidianas. Desarrolla tu comprensión auditiva y expresión oral.</p>
                    
                    <div class="features-grid">
                        <div class="feature-item">
                            <div class="feature-icon">
                                <i class="fas fa-redo"></i>
                            </div>
                            <div class="feature-text">Bucle de 30 segundos</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">
                                <i class="fas fa-hand-point-up"></i>
                            </div>
                            <div class="feature-text">Controles táctiles</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">
                                <i class="fas fa-volume-up"></i>
                            </div>
                            <div class="feature-text">Audio claro</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="feature-text">A tu propio ritmo</div>
                        </div>
                    </div>
                    
                    <div class="navigation-buttons">
                        <button class="nav-btn prev" id="prevLesson2">
                            <i class="fas fa-arrow-left"></i> Anterior
                        </button>
                        <button class="nav-btn next" disabled>
                            Próximamente <i class="fas fa-lock"></i>
                        </button>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-text">
                            <span>Progreso del curso</span>
                            <span>100%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Footer -->
            <div class="app-footer">
                <div>© 2023 Divélun - Aprende Japonés Interactivo</div>
                <div class="footer-links">
                    <a href="#" class="footer-link">Inicio</a>
                    <a href="#" class="footer-link">Lecciones</a>
                    <a href="#" class="footer-link">Ayuda</a>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
    <script>
        // Variables globales para los reproductores
        let player1, player2;
        
        // Configuración del bucle de 30 segundos
        const loopStart = 30;
        const loopEnd = 60;
        
        // ============================================
        // INICIALIZACIÓN DE LA LECCIÓN 1
        // ============================================
        function initializeLesson1() {
            // Elementos de la lección 1
            const startScreen1 = document.getElementById('startScreen1');
            const pauseOverlay1 = document.getElementById('pauseOverlay1');
            const pauseButton1 = document.getElementById('pauseButton1');
            const loopIndicator1 = document.getElementById('loopIndicator1');
            const touchCenter1 = document.getElementById('touchCenter1');
            const touchLeft1 = document.getElementById('touchLeft1');
            const touchRight1 = document.getElementById('touchRight1');
            
            let hasStarted1 = false;
            let isLooping1 = true;
            
            // Variables para control de toques
            let tapCount1 = 0;
            let tapTimeout1 = null;
            let lastTapTime1 = 0;
            let lastTapArea1 = null;
            
            // Inicializar reproductor
            player1 = new Plyr('#player1', {
                controls: ['play', 'duration'],
                fullscreen: { enabled: false },
                autoplay: false,
                muted: false,
                volume: 1,
                ratio: '16:9',
                youtube: { 
                    noCookie: true, 
                    rel: 0, 
                    modestbranding: 1,
                    playsinline: 1,
                    enablejsapi: 1
                }
            });
            
            // Función para manejar la reproducción
            function handlePlay1() {
                console.log('Lección 1: Reproduciendo');
                startScreen1.classList.add('hidden');
                pauseOverlay1.classList.remove('visible');
                hasStarted1 = true;
                
                // Cambiar icono del botón de pausa a pausa (dos barras)
                pauseButton1.innerHTML = `<i class="fas fa-pause"></i>`;
            }
            
            // Función para manejar la pausa
            function handlePause1() {
                console.log('Lección 1: Pausado');
                // Mostrar overlay de pausa
                if (hasStarted1 && player1.paused) {
                    pauseOverlay1.classList.add('visible');
                    
                    // Cambiar icono del botón de pausa a play (triángulo)
                    pauseButton1.innerHTML = `<i class="fas fa-play"></i>`;
                    
                    // También mostrar el overlay de inicio si el video terminó
                    if (player1.currentTime >= player1.duration - 0.5) {
                        startScreen1.classList.remove('hidden');
                        pauseButton1.innerHTML = `<i class="fas fa-play"></i>`;
                    }
                }
            }
            
            // Función para manejar toques en diferentes áreas
            function handleTap1(area) {
                const now = Date.now();
                const timeSinceLastTap = now - lastTapTime1;
                
                // Si es el primer toque o han pasado más de 300ms desde el último toque
                if (timeSinceLastTap > 300 || lastTapArea1 !== area) {
                    // Es un toque simple
                    tapCount1 = 1;
                    lastTapArea1 = area;
                    
                    // Configurar timeout para detectar si es un toque simple
                    if (tapTimeout1) clearTimeout(tapTimeout1);
                    tapTimeout1 = setTimeout(() => {
                        // Es un toque simple
                        if (area === 'center') {
                            // Área central: pausar o reproducir
                            if (player1.playing) {
                                player1.pause();
                            } else if (hasStarted1 && player1.paused) {
                                player1.play();
                            }
                        }
                        // Para áreas laterales, el toque simple no hace nada
                        tapCount1 = 0;
                    }, 300);
                } else {
                    // Es un segundo toque en menos de 300ms (doble toque)
                    tapCount1++;
                    if (tapTimeout1) clearTimeout(tapTimeout1);
                    
                    if (tapCount1 === 2) {
                        // Es un doble toque
                        if (area === 'left') {
                            // Doble toque izquierdo: retroceder 10 segundos
                            let newTime = player1.currentTime - 10;
                            if (isLooping1 && newTime < loopStart) {
                                newTime = loopStart;
                            }
                            player1.currentTime = Math.max(0, newTime);
                            showFeedback1(document.getElementById('feedbackLeft1'));
                        } else if (area === 'right') {
                            // Doble toque derecho: adelantar 10 segundos
                            let newTime = player1.currentTime + 10;
                            if (isLooping1 && newTime > loopEnd) {
                                newTime = loopEnd - 0.1;
                            }
                            player1.currentTime = Math.min(player1.duration || Infinity, newTime);
                            showFeedback1(document.getElementById('feedbackRight1'));
                        }
                        // Para área central, el doble toque no hace nada adicional
                        tapCount1 = 0;
                    }
                }
                
                lastTapTime1 = now;
            }
            
            // Función para mostrar feedback visual
            function showFeedback1(el) {
                el.classList.remove('animate'); 
                void el.offsetWidth;
                el.classList.add('animate');
                setTimeout(() => el.classList.remove('animate'), 500);
            }
            
            // Configurar eventos del reproductor
            player1.on('ready', () => {
                console.log('Lección 1: Reproductor listo');
                // Asegurar que el sonido esté activado
                player1.volume = 1;
                player1.muted = false;
                
                if (isLooping1) {
                    player1.currentTime = loopStart;
                }
            });
            
            // Manejar clic en el botón de reproducción inicial
            startScreen1.querySelector('.big-play-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                console.log('Lección 1: Clic en botón de reproducción inicial');
                
                // Ocultar inmediatamente el botón para dar feedback visual
                startScreen1.classList.add('hidden');
                
                // Asegurar que el sonido esté activado antes de reproducir
                player1.volume = 1;
                player1.muted = false;
                
                player1.play().then(() => {
                    console.log('Lección 1: Reproducción exitosa');
                    hasStarted1 = true;
                    
                    if (isLooping1 && player1.currentTime < loopStart) {
                        player1.currentTime = loopStart;
                    }
                }).catch(error => {
                    console.error('Lección 1: Error al reproducir:', error);
                    // Si falla, mostrar el botón de nuevo
                    startScreen1.classList.remove('hidden');
                    
                    // Intentar sin muted (ya que muted está en false)
                    player1.play().then(() => {
                        console.log('Lección 1: Reproducción exitosa en segundo intento');
                        hasStarted1 = true;
                    }).catch(err => {
                        console.error('Lección 1: Error en segundo intento:', err);
                        startScreen1.classList.remove('hidden');
                    });
                });
            });
            
            // Manejar clic en el botón azul de pausa/reproducción
            pauseButton1.addEventListener('click', (e) => {
                e.stopPropagation();
                console.log('Lección 1: Clic en botón azul de pausa/reproducción');
                
                // Si el video está pausado, reproducir
                if (player1.paused) {
                    player1.play();
                } else {
                    // Si el video está reproduciéndose, pausar
                    player1.pause();
                }
            });
            
            // Event listeners para las áreas táctiles
            touchCenter1.addEventListener('click', (e) => {
                e.stopPropagation();
                handleTap1('center');
            });
            
            touchLeft1.addEventListener('click', (e) => {
                e.stopPropagation();
                handleTap1('left');
            });
            
            touchRight1.addEventListener('click', (e) => {
                e.stopPropagation();
                handleTap1('right');
            });
            
            // Escuchar eventos de estado del reproductor
            player1.on('playing', handlePlay1);
            player1.on('play', handlePlay1);
            player1.on('pause', handlePause1);
            
            // Controlar el bucle durante la reproducción
            player1.on('timeupdate', () => {
                if (!isLooping1 || !player1.playing) return;
                
                if (player1.currentTime >= loopEnd) {
                    player1.currentTime = loopStart;
                }
                
                if (player1.currentTime < loopStart) {
                    player1.currentTime = loopStart;
                }
            });
            
            // Manejar cuando el video termina
            player1.on('ended', () => {
                console.log('Lección 1: Video terminado');
                startScreen1.classList.remove('hidden');
                pauseOverlay1.classList.remove('visible');
                
                // Cambiar icono del botón de pausa a play (triángulo)
                pauseButton1.innerHTML = `<i class="fas fa-play"></i>`;
            });
            
            // Activar/desactivar bucle al hacer clic en el indicador
            loopIndicator1.addEventListener('click', () => {
                isLooping1 = !isLooping1;
                if (isLooping1) {
                    loopIndicator1.innerHTML = `
                        <i class="fas fa-redo"></i>
                        <span>BUCLE: 30 SEGUNDOS</span>`;
                    loopIndicator1.style.pointerEvents = 'auto';
                    loopIndicator1.style.cursor = 'pointer';
                    
                    if (player1.playing && (player1.currentTime < loopStart || player1.currentTime > loopEnd)) {
                        player1.currentTime = loopStart;
                    }
                } else {
                    loopIndicator1.innerHTML = `
                        <i class="fas fa-redo" style="opacity:0.5;"></i>
                        <span style="opacity:0.5;">BUCLE DESACTIVADO</span>`;
                }
            });
            
            loopIndicator1.style.pointerEvents = 'auto';
            loopIndicator1.style.cursor = 'pointer';
            
            // Asegurarnos de que el video comience en el tiempo correcto
            player1.on('canplay', () => {
                console.log('Lección 1: Video listo para reproducir');
                if (isLooping1) {
                    player1.currentTime = loopStart;
                }
            });
            
            // Forzar la ocultación del botón si el video ya está reproduciéndose
            setTimeout(() => {
                if (player1 && player1.playing && !startScreen1.classList.contains('hidden')) {
                    console.log('Lección 1: Video ya reproduciéndose, ocultando botón');
                    startScreen1.classList.add('hidden');
                    hasStarted1 = true;
                }
            }, 1000);
        }
        
        // ============================================
        // INICIALIZACIÓN DE LA LECCIÓN 2
        // ============================================
        function initializeLesson2() {
            // Elementos de la lección 2
            const startScreen2 = document.getElementById('startScreen2');
            const pauseOverlay2 = document.getElementById('pauseOverlay2');
            const pauseButton2 = document.getElementById('pauseButton2');
            const loopIndicator2 = document.getElementById('loopIndicator2');
            const touchCenter2 = document.getElementById('touchCenter2');
            const touchLeft2 = document.getElementById('touchLeft2');
            const touchRight2 = document.getElementById('touchRight2');
            
            let hasStarted2 = false;
            let isLooping2 = true;
            
            // Variables para control de toques
            let tapCount2 = 0;
            let tapTimeout2 = null;
            let lastTapTime2 = 0;
            let lastTapArea2 = null;
            
            // Inicializar reproductor
            player2 = new Plyr('#player2', {
                controls: ['play', 'duration'],
                fullscreen: { enabled: false },
                autoplay: false,
                muted: false,
                volume: 1,
                ratio: '16:9',
                youtube: { 
                    noCookie: true, 
                    rel: 0, 
                    modestbranding: 1,
                    playsinline: 1,
                    enablejsapi: 1
                }
            });
            
            // Función para manejar la reproducción
            function handlePlay2() {
                console.log('Lección 2: Reproduciendo');
                startScreen2.classList.add('hidden');
                pauseOverlay2.classList.remove('visible');
                hasStarted2 = true;
                
                // Cambiar icono del botón de pausa a pausa (dos barras)
                pauseButton2.innerHTML = `<i class="fas fa-pause"></i>`;
            }
            
            // Función para manejar la pausa
            function handlePause2() {
                console.log('Lección 2: Pausado');
                // Mostrar overlay de pausa
                if (hasStarted2 && player2.paused) {
                    pauseOverlay2.classList.add('visible');
                    
                    // Cambiar icono del botón de pausa a play (triángulo)
                    pauseButton2.innerHTML = `<i class="fas fa-play"></i>`;
                    
                    // También mostrar el overlay de inicio si el video terminó
                    if (player2.currentTime >= player2.duration - 0.5) {
                        startScreen2.classList.remove('hidden');
                        pauseButton2.innerHTML = `<i class="fas fa-play"></i>`;
                    }
                }
            }
            
            // Función para manejar toques en diferentes áreas
            function handleTap2(area) {
                const now = Date.now();
                const timeSinceLastTap = now - lastTapTime2;
                
                // Si es el primer toque o han pasado más de 300ms desde el último toque
                if (timeSinceLastTap > 300 || lastTapArea2 !== area) {
                    // Es un toque simple
                    tapCount2 = 1;
                    lastTapArea2 = area;
                    
                    // Configurar timeout para detectar si es un toque simple
                    if (tapTimeout2) clearTimeout(tapTimeout2);
                    tapTimeout2 = setTimeout(() => {
                        // Es un toque simple
                        if (area === 'center') {
                            // Área central: pausar o reproducir
                            if (player2.playing) {
                                player2.pause();
                            } else if (hasStarted2 && player2.paused) {
                                player2.play();
                            }
                        }
                        // Para áreas laterales, el toque simple no hace nada
                        tapCount2 = 0;
                    }, 300);
                } else {
                    // Es un segundo toque en menos de 300ms (doble toque)
                    tapCount2++;
                    if (tapTimeout2) clearTimeout(tapTimeout2);
                    
                    if (tapCount2 === 2) {
                        // Es un doble toque
                        if (area === 'left') {
                            // Doble toque izquierdo: retroceder 10 segundos
                            let newTime = player2.currentTime - 10;
                            if (isLooping2 && newTime < loopStart) {
                                newTime = loopStart;
                            }
                            player2.currentTime = Math.max(0, newTime);
                            showFeedback2(document.getElementById('feedbackLeft2'));
                        } else if (area === 'right') {
                            // Doble toque derecho: adelantar 10 segundos
                            let newTime = player2.currentTime + 10;
                            if (isLooping2 && newTime > loopEnd) {
                                newTime = loopEnd - 0.1;
                            }
                            player2.currentTime = Math.min(player2.duration || Infinity, newTime);
                            showFeedback2(document.getElementById('feedbackRight2'));
                        }
                        // Para área central, el doble toque no hace nada adicional
                        tapCount2 = 0;
                    }
                }
                
                lastTapTime2 = now;
            }
            
            // Función para mostrar feedback visual
            function showFeedback2(el) {
                el.classList.remove('animate'); 
                void el.offsetWidth;
                el.classList.add('animate');
                setTimeout(() => el.classList.remove('animate'), 500);
            }
            
            // Configurar eventos del reproductor
            player2.on('ready', () => {
                console.log('Lección 2: Reproductor listo');
                // Asegurar que el sonido esté activado
                player2.volume = 1;
                player2.muted = false;
                
                if (isLooping2) {
                    player2.currentTime = loopStart;
                }
            });
            
            // Manejar clic en el botón de reproducción inicial
            startScreen2.querySelector('.big-play-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                console.log('Lección 2: Clic en botón de reproducción inicial');
                
                // Ocultar inmediatamente el botón para dar feedback visual
                startScreen2.classList.add('hidden');
                
                // Asegurar que el sonido esté activado antes de reproducir
                player2.volume = 1;
                player2.muted = false;
                
                player2.play().then(() => {
                    console.log('Lección 2: Reproducción exitosa');
                    hasStarted2 = true;
                    
                    if (isLooping2 && player2.currentTime < loopStart) {
                        player2.currentTime = loopStart;
                    }
                }).catch(error => {
                    console.error('Lección 2: Error al reproducir:', error);
                    // Si falla, mostrar el botón de nuevo
                    startScreen2.classList.remove('hidden');
                    
                    // Intentar sin muted (ya que muted está en false)
                    player2.play().then(() => {
                        console.log('Lección 2: Reproducción exitosa en segundo intento');
                        hasStarted2 = true;
                    }).catch(err => {
                        console.error('Lección 2: Error en segundo intento:', err);
                        startScreen2.classList.remove('hidden');
                    });
                });
            });
            
            // Manejar clic en el botón azul de pausa/reproducción
            pauseButton2.addEventListener('click', (e) => {
                e.stopPropagation();
                console.log('Lección 2: Clic en botón azul de pausa/reproducción');
                
                // Si el video está pausado, reproducir
                if (player2.paused) {
                    player2.play();
                } else {
                    // Si el video está reproduciéndose, pausar
                    player2.pause();
                }
            });
            
            // Event listeners para las áreas táctiles
            touchCenter2.addEventListener('click', (e) => {
                e.stopPropagation();
                handleTap2('center');
            });
            
            touchLeft2.addEventListener('click', (e) => {
                e.stopPropagation();
                handleTap2('left');
            });
            
            touchRight2.addEventListener('click', (e) => {
                e.stopPropagation();
                handleTap2('right');
            });
            
            // Escuchar eventos de estado del reproductor
            player2.on('playing', handlePlay2);
            player2.on('play', handlePlay2);
            player2.on('pause', handlePause2);
            
            // Controlar el bucle durante la reproducción
            player2.on('timeupdate', () => {
                if (!isLooping2 || !player2.playing) return;
                
                if (player2.currentTime >= loopEnd) {
                    player2.currentTime = loopStart;
                }
                
                if (player2.currentTime < loopStart) {
                    player2.currentTime = loopStart;
                }
            });
            
            // Manejar cuando el video termina
            player2.on('ended', () => {
                console.log('Lección 2: Video terminado');
                startScreen2.classList.remove('hidden');
                pauseOverlay2.classList.remove('visible');
                
                // Cambiar icono del botón de pausa a play (triángulo)
                pauseButton2.innerHTML = `<i class="fas fa-play"></i>`;
            });
            
            // Activar/desactivar bucle al hacer clic en el indicador
            loopIndicator2.addEventListener('click', () => {
                isLooping2 = !isLooping2;
                if (isLooping2) {
                    loopIndicator2.innerHTML = `
                        <i class="fas fa-redo"></i>
                        <span>BUCLE: 30 SEGUNDOS</span>`;
                    loopIndicator2.style.pointerEvents = 'auto';
                    loopIndicator2.style.cursor = 'pointer';
                    
                    if (player2.playing && (player2.currentTime < loopStart || player2.currentTime > loopEnd)) {
                        player2.currentTime = loopStart;
                    }
                } else {
                    loopIndicator2.innerHTML = `
                        <i class="fas fa-redo" style="opacity:0.5;"></i>
                        <span style="opacity:0.5;">BUCLE DESACTIVADO</span>`;
                }
            });
            
            loopIndicator2.style.pointerEvents = 'auto';
            loopIndicator2.style.cursor = 'pointer';
            
            // Asegurarnos de que el video comience en el tiempo correcto
            player2.on('canplay', () => {
                console.log('Lección 2: Video listo para reproducir');
                if (isLooping2) {
                    player2.currentTime = loopStart;
                }
            });
            
            // Forzar la ocultación del botón si el video ya está reproduciéndose
            setTimeout(() => {
                if (player2 && player2.playing && !startScreen2.classList.contains('hidden')) {
                    console.log('Lección 2: Video ya reproduciéndose, ocultando botón');
                    startScreen2.classList.add('hidden');
                    hasStarted2 = true;
                }
            }, 1000);
        }
        
        // ============================================
        // SISTEMA DE NAVEGACIÓN MEJORADO
        // ============================================
        function setupNavigation() {
            const lesson1 = document.getElementById('lesson1');
            const lesson2 = document.getElementById('lesson2');
            const nextLesson1Btn = document.getElementById('nextLesson1');
            const prevLesson2Btn = document.getElementById('prevLesson2');
            const lessonCounter = document.getElementById('lessonCounter');
            
            // Función para cambiar entre lecciones
            function switchLesson(fromLesson, toLesson) {
                // Detener el video actual si está reproduciéndose
                if (fromLesson === 'lesson1' && player1 && player1.playing) {
                    player1.pause();
                } else if (fromLesson === 'lesson2' && player2 && player2.playing) {
                    player2.pause();
                }
                
                // Cambiar visibilidad de las lecciones
                document.getElementById(fromLesson).classList.remove('active');
                document.getElementById(toLesson).classList.add('active');
                
                // Actualizar contador de lección
                if (toLesson === 'lesson1') {
                    lessonCounter.innerHTML = `<i class="fas fa-book-open"></i><span>Lección 1 de 2</span>`;
                } else if (toLesson === 'lesson2') {
                    lessonCounter.innerHTML = `<i class="fas fa-book-open"></i><span>Lección 2 de 2</span>`;
                }
                
                // Si vamos a la lección 2 y no se ha inicializado, inicializarla
                if (toLesson === 'lesson2' && !player2) {
                    initializeLesson2();
                }
            }
            
            // Event listeners para navegación
            nextLesson1Btn.addEventListener('click', () => {
                switchLesson('lesson1', 'lesson2');
            });
            
            prevLesson2Btn.addEventListener('click', () => {
                switchLesson('lesson2', 'lesson1');
            });
        }
        
        // ============================================
        // INICIALIZACIÓN GENERAL
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM cargado, inicializando...');
            
            // Inicializar la lección 1
            initializeLesson1();
            
            // Configurar navegación
            setupNavigation();
            
            console.log('Inicialización completa');
        });
        
    </script>
</body>
</html>
